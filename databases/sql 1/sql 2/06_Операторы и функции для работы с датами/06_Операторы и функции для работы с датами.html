<!DOCTYPE html>
<html lang="ru" data-react-helmet="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Яндекс.Практикум</title>
        <link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/suisse.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/ys.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/spectral.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/suisse.css" rel="stylesheet"><link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/ys.css" rel="stylesheet"><link data-react-helmet="true" href="./06_Операторы и функции для работы с датами_files/spectral.css" rel="stylesheet"><link data-react-helmet="true" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon.png" rel="shortcut icon" type="image/x-icon"><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/apple-touch-icon.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon-32x32.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon-16x16.png"><link data-react-helmet="true" rel="manifest" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/site.webmanifest"><link data-react-helmet="true" rel="mask-icon" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/safari-pinned-tab.svg" color="#000000">

        <link rel="stylesheet" href="./06_Операторы и функции для работы с датами_files/vendor.build.css">
        <link rel="stylesheet" href="./06_Операторы и функции для работы с датами_files/common.build.css">
        <link rel="stylesheet" href="./06_Операторы и функции для работы с датами_files/proficiency.build.css">
  <section class="lesson proficiency-page__content"><div class="markdown markdown_size_normal markdown_type_theory theory-viewer__markdown theory-viewer__markdown_flexible big-theory lesson__theory lesson__markdown"><h1>Операторы и функции для работы с датами</h1><div class="paragraph">Бизнес-процессы тесно увязаны со временем. </div><div class="paragraph">Например, чтобы оценить влияние погоды на покупательскую активность в интернет-магазине, важно знать, когда пользователь совершил покупку и какая погода была в тот момент. Нужно уметь соединять данные о времени из разных источников и группировать информацию по месяцу, дню или часу.</div><div class="paragraph">Две основные функции для работы со временем и датой — <strong>EXTRACT</strong> (англ. «извлекать») и <strong>DATE_TRUNC</strong> (от англ. <em>truncate date</em>, «усекать, отбрасывать дату»). Обе функции вызывают в блоке SELECT. </div><div class="paragraph">Шаблон функции EXTRACT: </div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">    <span class="hljs-keyword">SELECT</span>
      <span class="hljs-keyword">EXTRACT</span>(часть_даты <span class="hljs-keyword">FROM</span> столбец) <span class="hljs-keyword">AS</span> новый_столбец_с_датой 
    <span class="hljs-keyword">FROM</span> 
        Таблица_со_всеми_датами;</code></pre><div class="paragraph">Название функции определяет её суть. EXTRACT <em>извлекает</em> из даты нужную часть: год, месяц, минуту. Что ещё можно получить вызовом EXTRACT: </div><ul><li><code class="code-inline code-inline_theme_light">century</code> — век;</li><li><code class="code-inline code-inline_theme_light">day</code> — день;</li><li><code class="code-inline code-inline_theme_light">doy</code> (от англ. <em>day of the year</em>) — день года: от 1 до 365/366;</li><li><code class="code-inline code-inline_theme_light">isodow</code> (от англ. <em>day of the week</em> и ISO 8601, международного стандарта даты и времени) — день недели: понедельник — 1, воскресенье — 7.</li><li><code class="code-inline code-inline_theme_light">hour</code> — час;</li><li><code class="code-inline code-inline_theme_light">milliseconds</code> — миллисекунда;</li><li><code class="code-inline code-inline_theme_light">minute</code> — минута;</li><li><code class="code-inline code-inline_theme_light">second</code> — секунда;</li><li><code class="code-inline code-inline_theme_light">month</code> — месяц;</li><li><code class="code-inline code-inline_theme_light">quarter</code> — квартал;</li><li><code class="code-inline code-inline_theme_light">week</code> — неделя в году;</li><li><code class="code-inline code-inline_theme_light">year</code> — год.</li></ul><div class="paragraph">Вызовем функцию EXTRACT и получим из поля <em>log_on</em> таблицы <em>user_activity</em> (англ. «активность пользователей») два столбца — с месяцем и днём входа определённого пользователя в личный кабинет:</div><div class="table"><div class="scrollable-default scrollable scrollable_theme_light table__wrapper"><div></div><div class="scrollable__content-wrapper"><div class="scrollable__content-container" style="--scroll-bar-width:17px; --scroll-bar-height:17px;"><div class="scrollable__content"><table cellpadding="0" cellspacing="0"><thead><tr><th scope="col">id_user</th><th scope="col">log_on</th><th scope="col">log_off</th></tr></thead><tbody><tr><td>6</td><td>2019-03-01 23:34:55</td><td>2019-04-01 01:20:45</td></tr><tr><td>156</td><td>2019-07-03 17:59:21</td><td>2019-07-03 19:31:34</td></tr><tr><td>65</td><td>2019-03-25 14:30:46</td><td>2019-03-25 17:47:53</td></tr></tbody></table><div></div></div></div></div><section class="scrollbar-default scrollbar scrollbar_vertical scrollbar_hidden scrollbar_hoverable scrollable__scrollbar scrollable__scrollbar_type_vertical" style="--scrollbar-offset-size:149px; --scrollbar-control-size:149px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;" size="1"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section><section class="scrollbar-default scrollbar scrollbar_horizontal scrollbar_hidden scrollbar_hoverable scrollable__scrollbar scrollable__scrollbar_type_horizontal" style="--scrollbar-offset-size:698px; --scrollbar-control-size:698px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;" size="1"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section></div></div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
    id_user,
    <span class="hljs-keyword">EXTRACT</span>(<span class="hljs-keyword">MONTH</span> <span class="hljs-keyword">FROM</span> log_on) <span class="hljs-keyword">AS</span> month_activity,
    <span class="hljs-keyword">EXTRACT</span>(<span class="hljs-keyword">DAY</span> <span class="hljs-keyword">FROM</span> log_on) <span class="hljs-keyword">AS</span> day_activity
<span class="hljs-keyword">FROM</span> 
    user_activity;</code></pre><div class="table"><div class="scrollable-default scrollable scrollable_theme_light table__wrapper"><div></div><div class="scrollable__content-wrapper"><div class="scrollable__content-container" style="--scroll-bar-width:17px; --scroll-bar-height:17px;"><div class="scrollable__content"><table cellpadding="0" cellspacing="0"><thead><tr><th scope="col">user_activity</th><th scope="col">month_activity</th><th scope="col">day_activity</th></tr></thead><tbody><tr><td>6</td><td>3</td><td>1</td></tr><tr><td>156</td><td>7</td><td>3</td></tr><tr><td>65</td><td>3</td><td>25</td></tr></tbody></table><div></div></div></div></div><section class="scrollbar-default scrollbar scrollbar_vertical scrollbar_hidden scrollbar_hoverable scrollable__scrollbar scrollable__scrollbar_type_vertical" style="--scrollbar-offset-size:149px; --scrollbar-control-size:149px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;" size="1"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section><section class="scrollbar-default scrollbar scrollbar_horizontal scrollbar_hidden scrollbar_hoverable scrollable__scrollbar scrollable__scrollbar_type_horizontal" style="--scrollbar-offset-size:698px; --scrollbar-control-size:698px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;" size="1"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section></div></div><div class="paragraph">Пользователь под номером 6 входил в личный кабинет первого числа третьего месяца. А 156-ой пользователь — третьего числа седьмого месяца. </div><div class="paragraph"><strong>DATE_TRUNC</strong> <em>усекает</em> дату до часа, дня или месяца. В отличие от EXTRACT часть, до которой нужно усечь дату, записывают как строку. А столбец, откуда берут данные о времени, указывают через запятую: </div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span>
    DATE_TRUNC(<span class="hljs-string">'часть_даты_до_которой_усекаем'</span>, столбец) <span class="hljs-keyword">AS</span> новый_столбец_с_датой 
<span class="hljs-keyword">FROM</span> 
    Таблица_со_всеми_датами;</code></pre><div class="paragraph">Часть даты, до&nbsp;которой данные нужно «обнулить», указывают в&nbsp;аргументе функции DATE_TRUNC: </div><ul><li><code class="code-inline code-inline_theme_light">'microseconds'</code> — микросекунды;</li><li><code class="code-inline code-inline_theme_light">'milliseconds'</code> — миллисекунды;</li><li><code class="code-inline code-inline_theme_light">'second'</code> — секунда;</li><li><code class="code-inline code-inline_theme_light">'minute'</code> — минута;</li><li><code class="code-inline code-inline_theme_light">'hour'</code> — час;</li><li><code class="code-inline code-inline_theme_light">'day'</code> — день;</li><li><code class="code-inline code-inline_theme_light">'week'</code> — неделя;</li><li><code class="code-inline code-inline_theme_light">'month'</code> — месяц;</li><li><code class="code-inline code-inline_theme_light">'quarter'</code> — квартал;</li><li><code class="code-inline code-inline_theme_light">'year'</code> — год;</li><li><code class="code-inline code-inline_theme_light">'decade'</code> — декада года;</li><li><code class="code-inline code-inline_theme_light">'century'</code> — век.</li></ul><div class="paragraph">Знать точное время активности пользователя бывает важно. Однако, если нужно сгруппировать данные по дате и часу входа, минуты и секунды портят картину. Усечём значения поля <em>log_on</em> до часов.</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'hour'</span>,log_on) <span class="hljs-keyword">as</span> date_log_on
<span class="hljs-keyword">FROM</span> 
    user_activity;</code></pre><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">date_log_on

2019-03-01 23:00:00

2019-07-03 17:00:00

2019-03-25 14:00:00</code></pre></div><div class="lesson__markdown-btn"><button class="button button_size_m button_type_default button_theme_light button_view_normal button_has-hover-color lesson__button" type="button" style="--button-hover-color:var(--profession-color, $pureBlue);"><span class="button__text"><span>Перейти к заданию</span></span></button></div></section></div>
</body></html>