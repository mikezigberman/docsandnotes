<!DOCTYPE html>
<html lang="ru" data-react-helmet="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Яндекс.Практикум</title>
       <link data-react-helmet="true" href="./02_Изменение типов_files/suisse.css" rel="preload" as="style"><link data-react-helmet="true" href="./02_Изменение типов_files/ys.css" rel="preload" as="style"><link data-react-helmet="true" href="./02_Изменение типов_files/spectral.css" rel="preload" as="style"><link data-react-helmet="true" href="./02_Изменение типов_files/suisse.css" rel="stylesheet"><link data-react-helmet="true" href="./02_Изменение типов_files/ys.css" rel="stylesheet"><link data-react-helmet="true" href="./02_Изменение типов_files/spectral.css" rel="stylesheet"><link data-react-helmet="true" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon.png" rel="shortcut icon" type="image/x-icon"><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/apple-touch-icon.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon-32x32.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/favicon-16x16.png"><link data-react-helmet="true" rel="manifest" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/site.webmanifest"><link data-react-helmet="true" rel="mask-icon" href="https://yastatic.net/q/praktikum/v0.132.8-1591111175/static/safari-pinned-tab.svg" color="#000000">

        <link rel="stylesheet" href="./02_Изменение типов_files/vendor.build.css">
        <link rel="stylesheet" href="./02_Изменение типов_files/common.build.css">
        <link rel="stylesheet" href="./02_Изменение типов_files/proficiency.build.css">
    <section class="lesson proficiency-page__content"><div class="markdown markdown_size_normal markdown_type_theory theory-viewer__markdown theory-viewer__markdown_flexible big-theory lesson__theory lesson__markdown"><h1>Изменение типов</h1><div class="paragraph">Некоторые агрегирующие функции работают только с числовыми типами данных. Потому такой запрос не выполнится для <em>books:</em></div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span>
    <span class="hljs-keyword">AVG</span>(pages) <span class="hljs-keyword">AS</span> average
<span class="hljs-keyword">FROM</span>
    books;</code></pre><div class="paragraph">Взгляните на таблицу:</div><div class="paragraph"><strong>books</strong></div><div class="table"><div class="scrollable-default scrollable scrollable_theme_light table__wrapper table__wrapper_scrollable-x table__wrapper_scrollable-y"><div></div><div class="scrollable__content-wrapper"><div class="scrollable__content-container" style="--scroll-bar-width:17px; --scroll-bar-height:17px;"><div class="scrollable__content"><table cellpadding="0" cellspacing="0"><thead><tr><th scope="col" style="text-align: center;">id</th><th scope="col" style="text-align: center;">Name</th><th scope="col" style="text-align: center;">genre</th><th scope="col" style="text-align: center;">author</th><th scope="col" style="text-align: center;">date_pub</th><th scope="col" style="text-align: center;">pages</th><th scope="col" style="text-align: center;">price</th><th scope="col" style="text-align: center;">rating</th><th scope="col" style="text-align: center;">pub_name</th></tr></thead><tbody><tr><td style="text-align: center;">1</td><td style="text-align: center;">Капитанская дочка</td><td style="text-align: center;">5</td><td style="text-align: center;">Александр Пушкин</td><td style="text-align: center;">1836-01-01</td><td style="text-align: center;">130</td><td style="text-align: center;">150</td><td style="text-align: center;">4.7</td><td style="text-align: center;">АСТ</td></tr><tr><td style="text-align: center;">2</td><td style="text-align: center;">Отцы и дети</td><td style="text-align: center;">1</td><td style="text-align: center;">Иван Тургенев</td><td style="text-align: center;">1862-01-01</td><td style="text-align: center;">240</td><td style="text-align: center;">207</td><td style="text-align: center;">4.7</td><td style="text-align: center;">Белый город</td></tr><tr><td style="text-align: center;">3</td><td style="text-align: center;">Вишнёвый сад</td><td style="text-align: center;">7</td><td style="text-align: center;">Антон Чехов</td><td style="text-align: center;">1903-01-01</td><td style="text-align: center;">60</td><td style="text-align: center;">138</td><td style="text-align: center;">4.4</td><td style="text-align: center;">Росмэн</td></tr><tr><td style="text-align: center;">4</td><td style="text-align: center;">Война и мир</td><td style="text-align: center;">1</td><td style="text-align: center;">Лев Толстой</td><td style="text-align: center;">1869-01-01</td><td style="text-align: center;">1274</td><td style="text-align: center;"></td><td style="text-align: center;"></td><td style="text-align: center;">Знание</td></tr><tr><td style="text-align: center;">5</td><td style="text-align: center;">Анна Каренина</td><td style="text-align: center;">1</td><td style="text-align: center;">Лев    Толстой</td><td style="text-align: center;">1877-01-01</td><td style="text-align: center;">1000</td><td style="text-align: center;">126</td><td style="text-align: center;">4.6</td><td style="text-align: center;">Эксмо</td></tr><tr><td style="text-align: center;">6</td><td style="text-align: center;">Цветы для Элджернона</td><td style="text-align: center;">4</td><td style="text-align: center;">Дэниел    Киз</td><td style="text-align: center;">1959-01-01</td><td style="text-align: center;">250</td><td style="text-align: center;">280</td><td style="text-align: center;">4.7</td><td style="text-align: center;">ЛитРес</td></tr><tr><td style="text-align: center;">7</td><td style="text-align: center;">Похороните меня за плинтусом...</td><td style="text-align: center;">5</td><td style="text-align: center;">Павел    Санаев</td><td style="text-align: center;">1994-01-01</td><td style="text-align: center;">184</td><td style="text-align: center;">198</td><td style="text-align: center;">4.1</td><td style="text-align: center;">АСТ</td></tr><tr><td style="text-align: center;">8</td><td style="text-align: center;">Зелёная миля</td><td style="text-align: center;">9</td><td style="text-align: center;">Стивен    Кинг</td><td style="text-align: center;">1996-01-01</td><td style="text-align: center;">420</td><td style="text-align: center;">190</td><td style="text-align: center;">4.8</td><td style="text-align: center;">Белый город</td></tr><tr><td style="text-align: center;">9</td><td style="text-align: center;">Унесённые ветром</td><td style="text-align: center;">1</td><td style="text-align: center;">Маргарет    Митчел</td><td style="text-align: center;">1936-01-01</td><td style="text-align: center;">624</td><td style="text-align: center;">358</td><td style="text-align: center;"></td><td style="text-align: center;">Росмэн</td></tr><tr><td style="text-align: center;">10</td><td style="text-align: center;">Три товарища</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария Ремарк</td><td style="text-align: center;">1936-01-01</td><td style="text-align: center;">470</td><td style="text-align: center;">196</td><td style="text-align: center;">4.7</td><td style="text-align: center;">АСТ</td></tr><tr><td style="text-align: center;">11</td><td style="text-align: center;">На Западном фронте без перемен</td><td style="text-align: center;">4</td><td style="text-align: center;">Эрих Мария Ремарк</td><td style="text-align: center;">1929-01-01</td><td style="text-align: center;">200</td><td style="text-align: center;">273</td><td style="text-align: center;">4.6</td><td style="text-align: center;">Белый город</td></tr><tr><td style="text-align: center;">12</td><td style="text-align: center;">Триумфальная арка</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария    Ремарк</td><td style="text-align: center;">1945-01-01</td><td style="text-align: center;">520</td><td style="text-align: center;">220</td><td style="text-align: center;">4.7</td><td style="text-align: center;">Росмэн</td></tr><tr><td style="text-align: center;">13</td><td style="text-align: center;">Чёрный обелиск</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария Ремарк</td><td style="text-align: center;">1956-01-01</td><td style="text-align: center;">480</td><td style="text-align: center;">420</td><td style="text-align: center;">4.6</td><td style="text-align: center;">ЛитРес</td></tr><tr><td style="text-align: center;">14</td><td style="text-align: center;">Ночь в Лиссабоне</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария Ремарк</td><td style="text-align: center;">1961-01-01</td><td style="text-align: center;">250</td><td style="text-align: center;">187</td><td style="text-align: center;">4.7</td><td style="text-align: center;">ЛитРес</td></tr><tr><td style="text-align: center;">15</td><td style="text-align: center;">Жизнь взаймы</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария    Ремарк</td><td style="text-align: center;">1959-01-01</td><td style="text-align: center;">240</td><td style="text-align: center;">240</td><td style="text-align: center;">4.6</td><td style="text-align: center;">ЛитРес</td></tr><tr><td style="text-align: center;">16</td><td style="text-align: center;">Станция на горизонте</td><td style="text-align: center;">1</td><td style="text-align: center;">Эрих Мария Ремарк</td><td style="text-align: center;">1927-01-01</td><td style="text-align: center;">210</td><td style="text-align: center;"></td><td style="text-align: center;">4.1</td><td style="text-align: center;">Росмэн</td></tr><tr><td style="text-align: center;">17</td><td style="text-align: center;">Евгений Онегин</td><td style="text-align: center;">1</td><td style="text-align: center;">Александр    Пушкин</td><td style="text-align: center;">1832-01-01</td><td style="text-align: center;">736</td><td style="text-align: center;">330</td><td style="text-align: center;">4.7</td><td style="text-align: center;">Росмэн</td></tr></tbody></table><div></div></div></div></div><section class="scrollbar-default scrollbar scrollbar_vertical scrollbar_hoverable scrollbar_compact scrollable__scrollbar scrollable__scrollbar_type_vertical" style="--scrollbar-offset-size:333px; --scrollbar-control-size:87.3688px; --scrollbar-control-container-size:100%; --scrollbar-scale:0.96997; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section><section class="scrollbar-default scrollbar scrollbar_horizontal scrollbar_hoverable scrollbar_compact scrollable__scrollbar scrollable__scrollbar_type_horizontal" style="--scrollbar-offset-size:697px; --scrollbar-control-size:568.103px; --scrollbar-control-container-size:100%; --scrollbar-scale:0.985653; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section></div></div><div class="paragraph">Данные в выборке выглядят как числа, но в базе данных хранятся как строки. В жизни такое встречается часто — обычно из-за ошибок проектирования базы данных. </div><div class="paragraph">Изменим тип данных столбца в самом SQL-запросе. Типы преобразуют конструкцией <strong>CAST</strong> (от англ. «преобразование»): </div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">CAST (название_столбца AS тип_данных)</code></pre><div class="paragraph"><em>Название_столбца</em> — это поле, тип данных которого нужно преобразовать. <em>Тип_данных</em> — тип, в который данные нужно перевести. Есть и другая форма записи:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">название_столбца :: тип_данных</code></pre><div class="paragraph">Осталось познакомиться с типами данных в SQL. </div><h3>Числовые типы данных</h3><div class="paragraph"><strong>integer</strong> — целочисленный тип, аналогичный типу <em>int</em> в Python. В SQL диапазон целых чисел от -2147483648 до 2147483647.</div><div class="paragraph"><strong>real</strong> — число с плавающей точкой, как <em>float</em> в Python. Точность числа типа <em>real</em> до 6 десятичных разрядов.</div><h3>Строковые типы данных</h3><div class="paragraph"><strong>'Практикум'</strong> — значение строкового типа, в SQL запросе его заключают в одинарные кавычки. </div><div class="paragraph"><strong>varchar(n)</strong> — строка переменной длины, где <strong>n</strong> — ограничение. Этот тип данных похож на <em>string</em> в Python, но в отличие от него ограничен по длине: в поле можно занести любую строку короче, чем <strong>n</strong> символов. </div><div class="paragraph"><strong>text</strong> — строка любой длины. Полный аналог <em>string</em> в <em>Python</em>.</div><h3>Дата и время</h3><div class="paragraph">Любые вводимые значения даты или времени заключают в одинарные кавычки.</div><div class="paragraph"><strong>timestamp</strong> — дата и время. В формате <em>timestamp</em> чаще всего хранят события, происходящие несколько раз за день. Например, логи пользователей сайта. </div><div class="paragraph"><strong>date</strong> — дата. </div><h3>Логический</h3><div class="paragraph"><strong>boolean</strong> — логический тип данных. В SQL есть три варианта значений <strong>TRUE</strong> — «истина», <strong>FALSE</strong> — «ложь» и <strong>NULL</strong> — «неизвестно». </div><div class="paragraph">Вы изучили распространённые типы данных. Есть и много других. Вы можете познакомиться с ними самостоятельно в <a href="https://postgrespro.ru/docs/postgrespro/11/datatype" target="blank">документации</a>.</div><div class="paragraph">Вернёмся к «нерешаемой» задаче. Найдём среднее число страниц двумя способами:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">AVG</span>(pages :: <span class="hljs-built_in">integer</span>) <span class="hljs-keyword">AS</span> average
<span class="hljs-keyword">FROM</span>
    books;</code></pre><div class="paragraph">или:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">AVG</span> (<span class="hljs-keyword">CAST</span>(pages <span class="hljs-keyword">AS</span> <span class="hljs-built_in">integer</span>)) <span class="hljs-keyword">AS</span> average
<span class="hljs-keyword">FROM</span>
    books;</code></pre><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">428,7058824</code></pre><div class="paragraph">В данных о молочной продукции тоже есть ошибка. Данные поля <em>weight</em> записаны как строки, хотя на самом деле это числа. По такому поводу стоит написать баг-репорт. А пока исправьте эту ошибку локально, в запросе.</div></div><div class="lesson__markdown-btn"><button class="button button_size_m button_type_default button_theme_light button_view_normal button_has-hover-color lesson__button" type="button" style="--button-hover-color:var(--profession-color, $pureBlue);"><span class="button__text"><span>Перейти к заданию</span></span></button></div></section></div>
</body></html>