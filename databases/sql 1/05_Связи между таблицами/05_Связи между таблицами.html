<!DOCTYPE html>
<html lang="ru" data-react-helmet="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Яндекс.Практикум</title>
        <link data-react-helmet="true" href="./05_Связи между таблицами_files/suisse.css" rel="preload" as="style"><link data-react-helmet="true" href="./05_Связи между таблицами_files/ys.css" rel="preload" as="style"><link data-react-helmet="true" href="./05_Связи между таблицами_files/spectral.css" rel="preload" as="style"><link data-react-helmet="true" href="./05_Связи между таблицами_files/suisse.css" rel="stylesheet"><link data-react-helmet="true" href="./05_Связи между таблицами_files/ys.css" rel="stylesheet"><link data-react-helmet="true" href="./05_Связи между таблицами_files/spectral.css" rel="stylesheet"><link data-react-helmet="true" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon.png" rel="shortcut icon" type="image/x-icon"><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/apple-touch-icon.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon-32x32.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon-16x16.png"><link data-react-helmet="true" rel="manifest" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/site.webmanifest"><link data-react-helmet="true" rel="mask-icon" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/safari-pinned-tab.svg" color="#000000">

        <link rel="stylesheet" href="./05_Связи между таблицами_files/vendor.build.css">
        <link rel="stylesheet" href="./05_Связи между таблицами_files/common.build.css">
        <link rel="stylesheet" href="./05_Связи между таблицами_files/proficiency.build.css">

    <body id="bundle-proficiency" style="--profession-color:#264be0;">
        <!-- Яндекс — найдётся всё. Может даже ляпы в коде. -->
        <section class="lesson proficiency-page__content"><div class="markdown markdown_size_normal markdown_type_theory theory-viewer__markdown theory-viewer__markdown_flexible big-theory lesson__theory lesson__markdown"><h1>Связи между таблицами</h1><div class="paragraph">Запрос может быть обращён одновременно к нескольким таблицам базы данных.
Для этого:</div><ul><li>В поле <strong>FROM</strong> указывают, данные из каких таблиц надо получить.</li><li>В поле <strong>SELECT</strong> перечисляют имена столбцов, которые попадут в результирующую выборку. Если в разных таблицах имена столбцов повторяются, то их надо указывать по правилу <code class="code-inline code-inline_theme_light">ИмяТаблицы.ИмяСтолбца</code>.</li><li>В поле <strong>WHERE</strong> указывают условия получения данных из таблиц.</li></ul><div class="paragraph">Синтаксис запроса к нескольким таблицам выглядит так:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span>
    <span class="hljs-comment">-- Столбцы, данные из которых мы хотим получить в ответе на запрос.</span>
    <span class="hljs-comment">-- Для удобства можно задать новое имя для столбца командой AS </span>
    ИмяТаблицы<span class="hljs-number">1.</span>ИмяСтолбца<span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> firstField,
    ИмяТаблицы<span class="hljs-number">2.</span>ИмяСтолбца<span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> secondField,
    ...
<span class="hljs-keyword">FROM</span>
    <span class="hljs-comment">-- Таблицы, из которых запрашиваем данные:</span>
    ИмяТаблицы<span class="hljs-number">1</span>,
    ИмяТаблицы<span class="hljs-number">2</span>,
    ...
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-comment">-- Условия используют ту же нотацию: ИмяТаблицы.ИмяСтолбца</span>
    <span class="hljs-comment">-- Указываем, какими полями связаны записи в запрошенных таблицах</span>
    ИмяТаблицы<span class="hljs-number">1.</span>ИмяСтолбцаN = ИмяТаблицы<span class="hljs-number">2.</span>ИмяСтолбцаM</code></pre><div class="paragraph">Наиболее частый способ для связи между таблицами — это связь через поля с первичным ключом. </div><div class="paragraph">Каждая запись в таблицах <em>book</em> и <em>spouse</em> ссылается на значение в колонке <code class="code-inline code-inline_theme_light">id</code> таблицы <em>author</em>. По этой связи несложно определить, кто написал пьесу «Ива́нов» или чьей женой была Ольга Книппер.</div><img alt="image" class="image image_expandable" src="./05_Связи между таблицами_files/Untitled_7_1574411937.png">
<div class="paragraph">При создании таблицы в базе данных мы создавали поле, обозначенное как «первичный ключ», <code class="code-inline code-inline_theme_light">PRIMARY KEY</code>. Сейчас этот ключ понадобится, так что повторим его свойства:</div><ul><li>Первичные ключи уникальны, в колонке со свойством PRIMARY KEY значения не могут повторяться.</li><li>При создании новых записей базы данных могут сами генерировать значения для первичных ключей.</li><li>В некоторых СУБД можно проверять, есть ли запись в таблице, на которую ссылается запись из другой таблицы.</li></ul><div class="paragraph">Продолжим работать с базой русской литературы. Таблица <em>author</em> содержит имена и годы рождения авторов. Таблица <em>book</em> содержит название и год написания книги, а также ID автора из таблицы <em>author</em>. </div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-comment">-- создаём таблицу author и определяем, что в ней будут </span>
<span class="hljs-comment">-- колонки id, name и birth_year</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> author(
    <span class="hljs-comment">-- в таблице author в колонке id содержатся целые числа, </span>
    <span class="hljs-comment">-- в этой колонке каждая ячейка содержит уникальное значение</span>
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span>, 
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">TEXT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    birth_year <span class="hljs-built_in">INTEGER</span>
);

<span class="hljs-comment">-- создаём таблицу book </span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> book (
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span>, 
    title <span class="hljs-built_in">VARCHAR</span>, 
    <span class="hljs-keyword">year</span> <span class="hljs-built_in">INTEGER</span>, 
    author_id <span class="hljs-built_in">INTEGER</span>, 
    <span class="hljs-comment">-- Это специальный синтаксис, который связывает </span>
    <span class="hljs-comment">-- записи с таблицей авторов</span>
    <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span>(author_id) <span class="hljs-keyword">REFERENCES</span> author(<span class="hljs-keyword">id</span>)
);</code></pre><div class="paragraph">Графическое представление связи между таблицами:</div><img alt="image" class="image image_expandable" src="./05_Связи между таблицами_files/author_1574781472.jpg">
<div class="paragraph">Заполним таблицу авторов и таблицу книг:</div><img alt="image" class="image image_expandable" src="./05_Связи между таблицами_files/Untitled_8_1574411941.png">
<div class="paragraph">Получим информацию о книгах, опубликованных в 1866 году, и об авторах этих книг. Для этого составим запрос, который вернет нам из таблицы <em>author</em> имя автора, а из таблицы <em>book</em> — название и год издания литературного произведения.</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
  <span class="hljs-comment">-- Поля, которые мы хотим получить в ответе</span>
  author.name,
  book.title,
  book.year
<span class="hljs-keyword">FROM</span> 
  <span class="hljs-comment">-- Таблицы, из которых запрашиваем данные:</span>
  author,
  book
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-comment">-- В таблице book найти строки, в которых поле year содержит "1886"</span>
  book.year = <span class="hljs-number">1886</span> 
  <span class="hljs-keyword">AND</span> 
  <span class="hljs-comment">-- И значение поля book.author_id должно быть равно значению author.id</span>
  book.author_id = author.id;</code></pre><div class="paragraph">Результирующая выборка, полученная по нашему запросу:</div><pre class="code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span></div><code class="code-block__code">name               title                                                year      
----------------  ---------------------------------------------------   ---------
Лев Толстой        Власть тьмы, или Коготок увяз, всей птичке пропасть  1886      
Антон Чехов        О вреде табака                                       1886
Софья Ковалевская  Воспоминания о Джордже Эллиоте                       1886</code></pre><div class="quiz quiz_options-type_checkbox quiz quiz_answered quiz_type_select quiz_blocking"><div class="markdown markdown_size_normal markdown_type_theory quiz__content"><div class="paragraph">Выберите верные утверждения</div></div><section class="checbox-group-default checbox-group checkbox-group-sketch quiz__group" role="group" name="quiz-select-b30541f5-bc29-42e6-aea3-21b3b2ad6288-1"><div class="quiz__option-container quiz__option-container_checked quiz__option-container_correct"><label class="checkbox-default checkbox checkbox_disabled checkbox-sketch checkbox-group__item quiz__option"><input class="checkbox__input" type="checkbox" value="0" disabled=""><div class="checkbox__control"><svg class="icon icon-tick checkbox__tick" width="24" height="24" viewBox="0 0 24 24"><path d="M11.196 14.641l-.67.743.701.632.672-.663-.703-.712zm-3.311-1.639l2.64 2.382 1.34-1.485-2.641-2.382-1.34 1.485zm4.014 2.35l4.817-4.763-1.406-1.422-4.818 4.763 1.407 1.422z" fill="currentColor"></path></svg></div><div class="checkbox__label"><div class="checkbox-default__label checkbox__label checkbox-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">В таблице может быть только один PRIMARY KEY</div></div><div class="markdown markdown_size_normal markdown_type_theory quiz__feedback"><div class="paragraph">Это верно в большинстве случаев. Бывают ещё композитные таблицы, состоящие только из пар ключей, но мы их затрагивать не будем.</div></div></div></div></label></div><div class="quiz__option-container quiz__option-container_checked quiz__option-container_error"><label class="checkbox-default checkbox checkbox_disabled checkbox-sketch checkbox-group__item quiz__option"><input class="checkbox__input" type="checkbox" value="1" disabled=""><div class="checkbox__control"><svg class="icon icon-tick checkbox__tick" width="24" height="24" viewBox="0 0 24 24"><path d="M11.196 14.641l-.67.743.701.632.672-.663-.703-.712zm-3.311-1.639l2.64 2.382 1.34-1.485-2.641-2.382-1.34 1.485zm4.014 2.35l4.817-4.763-1.406-1.422-4.818 4.763 1.407 1.422z" fill="currentColor"></path></svg></div><div class="checkbox__label"><div class="checkbox-default__label checkbox__label checkbox-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">В столбце, отмеченном как PRIMARY KEY, могут присутствовать повторяющиеся значения.</div></div><div class="markdown markdown_size_normal markdown_type_theory quiz__feedback"><div class="paragraph">Нет, значения PRIMARY KEY должны быть уникальны в пределах одной таблицы.</div></div></div></div></label></div><div class="quiz__option-container quiz__option-container_checked quiz__option-container_correct"><label class="checkbox-default checkbox checkbox_disabled checkbox-sketch checkbox-group__item quiz__option"><input class="checkbox__input" type="checkbox" value="2" disabled=""><div class="checkbox__control"><svg class="icon icon-tick checkbox__tick" width="24" height="24" viewBox="0 0 24 24"><path d="M11.196 14.641l-.67.743.701.632.672-.663-.703-.712zm-3.311-1.639l2.64 2.382 1.34-1.485-2.641-2.382-1.34 1.485zm4.014 2.35l4.817-4.763-1.406-1.422-4.818 4.763 1.407 1.422z" fill="currentColor"></path></svg></div><div class="checkbox__label"><div class="checkbox-default__label checkbox__label checkbox-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">Значения первичных ключей можно писать руками при создании записей.</div></div><div class="markdown markdown_size_normal markdown_type_theory quiz__feedback"><div class="paragraph">Да, но можно и не писать, в большинстве случаев база сама присвоит записи уникальный идентификатор.</div></div></div></div></label></div></section></div>
<pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span>
  author.name <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>,
  book.title <span class="hljs-keyword">AS</span> title,
  book.year <span class="hljs-keyword">AS</span> <span class="hljs-keyword">year</span>
<span class="hljs-keyword">FROM</span>
    author,
  book
<span class="hljs-keyword">WHERE</span>
    &lt;условие&gt;</code></pre><div class="quiz quiz quiz_answered quiz_type_select quiz_blocking"><div class="markdown markdown_size_normal markdown_type_theory quiz__content"><div class="paragraph">Какое условие нужно дописать в блоке WHERE, чтобы выбрать все книги Достоевского, написанные с 1875 года включительно?</div></div><section class="radio-group-default radio-group radio-group-sketch radio-group quiz__group" role="radiogroup"><div class="quiz__option-container quiz__option-container_checked quiz__option-container_error"><label class="radio-default radio radio_checked radio_disabled radio-sketch radio radio-group__item quiz__option"><input aria-checked="true" class="radio__input" name="quiz-select-b30541f5-bc29-42e6-aea3-21b3b2ad6288-2" type="radio" value="0" disabled=""><div class="radio__control"><div class="radio__circle"></div></div><div class="radio-default__label radio__label radio-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">name = 'Фёдор Достоевский' AND book.author_id = author.id</div></div><div class="markdown markdown_size_normal markdown_type_theory quiz__feedback"><div class="paragraph">Тут мы забыли указать ограничение по году, в результате получим все книги Достоевского, которые есть в таблице.</div></div></div></label></div><div class="quiz__option-container"><label class="radio-default radio radio_disabled radio-sketch radio radio-group__item quiz__option"><input aria-checked="false" class="radio__input" name="quiz-select-b30541f5-bc29-42e6-aea3-21b3b2ad6288-2" type="radio" value="1" disabled=""><div class="radio__control"><div class="radio__circle"></div></div><div class="radio-default__label radio__label radio-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">author = 'Фёдор Достоевский' AND book.author_id = author.id</div></div></div></label></div><div class="quiz__option-container quiz__option-container_correct"><label class="radio-default radio radio_disabled radio-sketch radio radio-group__item quiz__option"><input aria-checked="false" class="radio__input" name="quiz-select-b30541f5-bc29-42e6-aea3-21b3b2ad6288-2" type="radio" value="2" disabled=""><div class="radio__control"><div class="radio__circle"></div></div><div class="radio-default__label radio__label radio-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">name = 'Фёдор Достоевский' AND book.author_id = author.id AND year &gt; = 1875</div></div><div class="markdown markdown_size_normal markdown_type_theory quiz__feedback"><div class="paragraph">Истинно так!</div></div></div></label></div><div class="quiz__option-container"><label class="radio-default radio radio_disabled radio-sketch radio radio-group__item quiz__option"><input aria-checked="false" class="radio__input" name="quiz-select-b30541f5-bc29-42e6-aea3-21b3b2ad6288-2" type="radio" value="3" disabled=""><div class="radio__control"><div class="radio__circle"></div></div><div class="radio-default__label radio__label radio-sketch__label"><div class="markdown markdown_size_normal markdown_type_theory quiz__option-label"><div class="paragraph">name = 'Фёдор Достоевский' AND book.author_id = author.id OR year &gt; = 1875</div></div></div></label></div></section></div>
</div><div class="lesson__markdown-btn"><button class="button button_size_m button_type_default button_theme_light button_view_normal button_has-hover-color lesson__button" type="button" style="--button-hover-color:var(--profession-color, $pureBlue);"><span class="button__text"><span>Вперед</span></span></button></div></section>
</body></html>