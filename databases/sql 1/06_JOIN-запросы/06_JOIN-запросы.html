<!DOCTYPE html>
<html lang="ru" data-react-helmet="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Яндекс.Практикум</title>
         <link data-react-helmet="true" href="./06_JOIN-запросы_files/suisse.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_JOIN-запросы_files/ys.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_JOIN-запросы_files/spectral.css" rel="preload" as="style"><link data-react-helmet="true" href="./06_JOIN-запросы_files/suisse.css" rel="stylesheet"><link data-react-helmet="true" href="./06_JOIN-запросы_files/ys.css" rel="stylesheet"><link data-react-helmet="true" href="./06_JOIN-запросы_files/spectral.css" rel="stylesheet"><link data-react-helmet="true" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon.png" rel="shortcut icon" type="image/x-icon"><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/apple-touch-icon.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon-32x32.png"><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/favicon-16x16.png"><link data-react-helmet="true" rel="manifest" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/site.webmanifest"><link data-react-helmet="true" rel="mask-icon" href="https://yastatic.net/q/praktikum/v0.129.20-1588763920/static/safari-pinned-tab.svg" color="#000000">

        <link rel="stylesheet" href="./06_JOIN-запросы_files/vendor.build.css">
        <link rel="stylesheet" href="./06_JOIN-запросы_files/common.build.css">
        <link rel="stylesheet" href="./06_JOIN-запросы_files/proficiency.build.css">

    <body id="bundle-proficiency" style="--profession-color:#264be0;">
        <!-- Яндекс — найдётся всё. Может даже ляпы в коде. -->
    <section class="lesson proficiency-page__content"><div class="markdown markdown_size_normal markdown_type_theory theory-viewer__markdown theory-viewer__markdown_flexible big-theory lesson__theory lesson__markdown"><h1>JOIN-запросы</h1><div class="paragraph">Прекрасный способ сделать выборку из нескольких таблиц — это запрос с ключевым словом <strong>JOIN.</strong> В JOIN-запросе можно указать тип связи между таблицами и условие их объединения. </div><div class="paragraph">Тип связи для JOIN может быть указан ключевыми словами <strong>FULL, OUTER/INNER, LEFT/RIGHT</strong>. Если тип связи явно не указан, то применяется <strong>INNER JOIN</strong>. </div><div class="paragraph">В запросе блок <strong>JOIN</strong> идёт сразу после блока <strong>FROM</strong>:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span>
    <span class="hljs-comment">-- Имена столбцов результата</span>
    Таблица<span class="hljs-number">1.</span>ИмяСтолбца<span class="hljs-number">1</span>,
    ...
<span class="hljs-keyword">FROM</span>
    <span class="hljs-comment">-- Запрашиваем данные ИЗ таблицы Таблица1</span>
    Таблица<span class="hljs-number">1</span>
<span class="hljs-comment">-- к результатам из Таблица1 ПРИСОЕДИНИТЬ данные из таблицы Таблица2</span>
<span class="hljs-keyword">JOIN</span> Таблица<span class="hljs-number">2</span>
    <span class="hljs-comment">-- Условия объединения</span>
    <span class="hljs-keyword">ON</span> Таблица<span class="hljs-number">1.</span>ИмяСтолбцаN = Таблица<span class="hljs-number">2.</span>ИмяСтолбцаM
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-comment">-- Дополнительные условия</span></code></pre><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/Untitled_9_1574412431.png">
<div class="paragraph">Так вы уже умеете, вы делали это в прошлом уроке:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">    <span class="hljs-keyword">SELECT</span> 
      author.name,
      book.title,
      book.year
    <span class="hljs-keyword">FROM</span> 
      author,
      book
    <span class="hljs-keyword">WHERE</span>
      book.year = <span class="hljs-number">1886</span> <span class="hljs-keyword">AND</span> book.author_id = author.id;</code></pre><div class="paragraph">Аналогичный запрос с ключевым словом JOIN выглядит так:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> 
<span class="hljs-comment">-- ВЫБРАТЬ данные из колонок //указываем имена колонок вместе с именем таблицы//</span>
    author.name,
    book.title,
    book.year
<span class="hljs-keyword">FROM</span> 
    <span class="hljs-comment">-- Запрашиваем данные ИЗ ТАБЛИЦЫ author</span>
    author
<span class="hljs-comment">-- к результатам ПРИСОЕДИНИТЬ данные из таблицы book</span>
<span class="hljs-keyword">JOIN</span> book
    <span class="hljs-comment">-- показать только те записи, в которых</span>
    <span class="hljs-comment">-- значение поля book.author_id равно значению поля author.id</span>
    <span class="hljs-keyword">ON</span> book.author_id = author.id
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-comment">-- из всего найденного показать только те результаты, </span>
    <span class="hljs-comment">-- где значение поля book.year равно "1886"</span>
    book.year = <span class="hljs-number">1886</span>;</code></pre><div class="paragraph">Результат обоих запросов будет одинаков:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">name               title                                                year      
<span class="hljs-comment">----------------  ---------------------------------------------------   ---------</span>
Лев Толстой        Власть тьмы, или Коготок увяз, всей птичке пропасть  1886      
Антон Чехов        О вреде табака                                       1886
Софья Ковалевская  Воспоминания о Джордже Эллиоте                       1886</code></pre><div class="paragraph">Но только JOIN может без особых ухищрений сделать запрос «SQL, найди мне всех авторов в таблице author, у которых нет ни одной книги в таблице book»:
<code class="code-inline code-inline_theme_light">sql
    SELECT 
      author.id,
      author.name,
      author.birth_year
    FROM 
      author
    LEFT JOIN book
      ON book.author_id = author.id
    WHERE
      book.title IS NULL;</code></div><div class="paragraph">Результат:</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs">    id  name            birth_year
    <span class="hljs-comment">--  --------------  -----------</span>
    4   Насон Грядущий  3019</code></pre><div class="paragraph">При обработке запроса JOIN в вычислениях участвуют две таблицы, которые условно называют <strong>«левая»</strong> и <strong>«правая»</strong>. «Левая» — это та, которая вызвана в блоке FROM, «правая» указывается после ключевого слова JOIN.</div><div class="paragraph">Запрос JOIN позволяет назначить одну из таблиц «главной», а из другой таблицы вывести данные, связанные с найденными в «главной».</div><div class="paragraph">Тип этой связи может быть указан ключевыми словами <strong>FULL OUTER, INNER, LEFT, RIGHT</strong>. По умолчанию применяется <strong>INNER</strong>. </div><div class="paragraph">Ключевое слово назначает «главной» таблицей «левую» (при <strong>LEFT JOIN</strong>) или «правую» (при <strong>RIGHT JOIN</strong>). В примере запроса о писателях без книг «левая» таблица — это <code class="code-inline code-inline_theme_light">author</code>, а «правая» — <code class="code-inline code-inline_theme_light">book</code>.</div><div class="paragraph">При запросах <strong>FULL OUTER JOIN</strong> и <strong>INNER JOIN</strong> таблицы равнозначны, «главной» нет.</div><div class="paragraph">Вот фрагмент базы данных детского сада. В <em>таблице А</em> собраны мальчики, в <em>таблице Б</em> — девочки. Дети одеты в карнавальные костюмы.</div><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-comment">-- Табл. А    Табл. Б</span>

id costume    id  costume
<span class="hljs-comment">-- --------   --  ---------</span>
1  Пират      1   Жучка
2  Снежинка   2   Пират
3  Котик      3   Принцесса
4  Буратино   4   Котик</code></pre><div class="paragraph">Дети не очень понимают как себя вести, но воспитатель хочет, чтобы они все вместе начали что-то делать. В зависимости от задач дети будут разбиваться на пары или собираться в какие-то группы.</div><ul><li><strong>INNER JOIN</strong> выберет из перечисленных таблиц только те записи, у которых совпадают значения заданных в условии <strong>ON</strong> полей. Подойдёт для танцев, где каждому участнику нужна пара в таком же костюме. Находим одинаковых и отправляем на сцену, остальных не показываем. Пусть сидят у стенки на стульчиках.</li></ul><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-comment">-- вернуть все поля из таблицы TableA</span>
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> TableA
<span class="hljs-comment">-- дополнительно запросить данные из таблицы TableB</span>
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> TableB
    <span class="hljs-comment">-- и возвращать записи, в которых </span>
    <span class="hljs-comment">-- для значения TableA.costume найдено такое же в TableB.costume</span>
    <span class="hljs-keyword">ON</span> TableA.costume = TableB.costume;

<span class="hljs-comment">-- Ответ:</span>

id costume    id  costume
<span class="hljs-comment">-- --------   --  ---------</span>
1  Пират      2   Пират
3  Котик      4   Котик</code></pre><div class="paragraph">Графическое представление <strong>INNER JOIN</strong></div><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/inner_join_1574770490.jpg">
<ul><li>При запросе <strong>FULL OUTER JOIN</strong> выводятся все записи из обеих таблиц. Те записи, у которых запрошенные значения совпадают — выводятся парами, остальные выводятся поодиночке. Всё примерно так же, как в прошлом примере, но те, у кого нет пары — тоже выходят на сцену.</li></ul><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> TableA
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> 
    TableB
<span class="hljs-keyword">ON</span> 
    TableA.costume = TableB.costume;

<span class="hljs-comment">-- Ответ:</span>

id    costume    id    costume
<span class="hljs-comment">----  --------   ----  ---------</span>
1     Пират      2     Пират
2     Снежинка   null  null
null  null       1     Жучка
3     Котик      4     Котик
null  null       3     Принцесса
4     Буратино   null  null</code></pre><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/table_a_1574766426.jpg">
<ul><li><strong>LEFT JOIN</strong> — в результат попадают все подходящие записи из левой таблицы, а из правой — только записи, отвечающие условию в блоке <strong>ON</strong>. Всех мальчиков просят выйти и стать в ряд, и только те девочки, для которых есть пара, могут стать рядом с мальчиками.</li></ul><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> TableA
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
    TableB
<span class="hljs-keyword">ON</span> 
    TableA.costume = TableB.costume;

<span class="hljs-comment">-- Ответ:</span>

id costume    id    costume
<span class="hljs-comment">-- --------   ----  ---------</span>
1  Пират      2     Пират
2  Снежинка   null  null
3  Котик      4     Котик
4  Буратино   null  null</code></pre><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/table_b_1574766472.jpg">
<ul><li><strong>RIGHT JOIN</strong> — в результат попадают все подходящие записи из правой таблицы, а из левой — только записи, отвечающие условию в блоке <strong>ON</strong>. Все девочки выходят на сцену, а мальчиков выпускают только тех, для кого есть пара.</li></ul><pre class="sql code-block code-block_theme_light"><div class="code-block__tools"><span class="code-block__clipboard">Скопировать код</span><span class="code-block__lang">SQL</span></div><code class="code-block__code sql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> TableA
<span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> 
    TableB
<span class="hljs-keyword">ON</span> 
    TableA.costume = TableB.costume;

<span class="hljs-comment">-- Ответ:</span>

id   costume    id    costume
<span class="hljs-comment">---- --------   ----  ---------</span>
null  null       1    Жучка
1     Пират      2    Пират
null  null       3    Принцесса
3     Котик      4    Котик</code></pre><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/right_join_1_1574770499.jpg">
<div class="paragraph">В зависимости от конкретной базы синтаксис JOIN-запросов может меняться, но обычно есть возможность выбрать необходимую комбинацию модификаторов LEFT, RIGHT, FULL и OUTER для создания необходимого JOIN-запроса.</div><img alt="image" class="image image_expandable" src="./06_JOIN-запросы_files/outer_join_1574766591.jpg">
</div><div class="lesson__markdown-btn"><button class="button button_size_m button_type_default button_theme_light button_view_normal button_has-hover-color lesson__button" type="button" style="--button-hover-color:var(--profession-color, $pureBlue);"><span class="button__text"><span>Перейти к заданию</span></span></button></div></section>
</body></html>